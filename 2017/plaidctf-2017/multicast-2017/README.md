# PlaidCTF 2017: Multicast (Crypto, 175)

說明：

> Many messages intercepted. Break them.

### 簡介

打開個 encryption 段 code 睇, 發現係 RSA with small encryption key: `c = (a m + b)^5 (mod n)`。

個 data.txt 俾左五組唔同既 `(a, b, c, n)`, 而個 `m` 係固定既, 明眼人一睇就知係 broadcast attack, 岩岩好用到 Hastad's attack。

其實都係分幾部份:

1. __用 CRT 將果五條 congruence 砌返做一條大既 congruence (`F(m) = 0 (mod N)`)__

不過係開始之前執靚條式: `(m + a^-1 b)^5 - a^-5 c = 0 (mod n)`, 搞到佢變返做幾條 monic polynomial congruence, 後面玩都開心少少。

跟住用 CRT 一砌, 拎到 `N` 同埋一條 polynomial。

```
N = 9527493287713574284974400204366439423149062247607270545696499023444965866841578884197679839254471587041445509857718629237056248669038979601782642806377833108052302335746693936764652502631227487580220163395486792239856056380614157391059047431802532698151441962882255468277076551520865171574767334640819593779613280190585564368468731711294174607924349482625790147512272392419559922588733735972600312367686152330795329996181661084073762884716731590459588420416530570798530836216395652386668495044793434309330342177175701165170402161383176798901648783306544122101186884094347102190066851715415262203134773701599787708597763592037796843353179553810359855009934971333215528310498861284818638655917876442320043062480880063130583665608016969891695349392580096419463812751499742345096402622134600416413745372214513104388069964220462634864672352912220205613945275639947715999114801245595337181507805210095522941701715107092703106150333902694766090278626172161994184469209913352874281667549439328960033992592426985233386748359728386385769126872860351912447010495450877735227092847259835605326509606447189886871757911562007051596909330997422377075574386882261563436590378555694032246615019438214893674427077966388438366488580107074901137520901827270178912603268134648905647242177281637708806173679898414187635557559290680823152524070561640949449847228936578369684526507492083639205759146501041803571555539115023067673787605521077597584956105519588260331459755178613637354159607977282802637735704555544604400688412481723420169424322257199312925973146179
x^5 + 6125428962696654972110608514380167712529359429080938333950264782573115147888722403882950133922339412644759769243006413906120017960424701913583090233136751428108653550044790646705487719015226906881509957450959405104749397495719070701816115012277234294081930264052185018328078694933783492864912238616151650076158243512074885606543516080908702573209615745814845585238419280670761962704676386098869586377168477210154311110951319653080659464495417642808718385357469421075760643378844208346995859875206381728033280062963595874736092457571385242079952959930199531805991407090590238418720857721251549093767421562759246021190338022279325850888676242159942580595452380094020133597414270440848584876634674346293952435005957198403471446799770288759140731736064594423211480277591320764358356281296067396502958163597840066592487585677384496807064273294051665582009912067707844183415296662204129101782462292924401368183547118798658153191242552027337917631130666406782837223820943553064099790045121023078853741145413381046113689599671173985503655340710846378848861044943436165954931304282858371353059271087203274541299653896724133630410287782861558008852777349135663637484747067720745790904143268878697580044936094007853451357402672347413007975086575093827696726648084686560396567113472636089575329487569797076955329916972955759858716045606638661693107749099101148736925733464857806465428747209183758544590788375176495635580854014874512190360583728293032760653431054992773925106628206756949293717784282981034637354730709776601843783675201474037911872159565*x^4 + 8183126914911126943908202641107637964716399637037381121760603544330893001161366610961120840949480917732309177372811703091991027906571290331146691948744930726693330234806147871308214069891209436444485093303451695548574586338382718627347973418831110606532333288128972933544489321347985639649619416234017123913927896884720032844617603084978215981319534257153356790286227893126168630419819653591739294166159487123612003564029414154114533922886016314754023906370097565697422905006680963578176709717151610961618299885531634463871171497063711063502227895858206506324047987324765412827659350862922931533508114156796509485103237036506440953007876850997409984686121635546873400963896027417360717733654102924266898993732356828914346839622675682175250994129556917648591712934234841049808686675779322395424570307977882022226041829064614435389112539980537960526777879952331715361298156508968512993120538761813257350630865253118502144361777128789736522473399320313806245150346757533572837190609972136926659169545411355979266862267563903229046097492260665418932058971046532012508392036213078093411186187158244584469282554816776032181482363796334305774336860168237054066954943548752456356555867510545983674596126723960590439575362190489528513615068844034762673976663831727320857490734229838366101650163336882039522639316512923130791224412594589736399991078190436316773812724560837389180592393985388907678349833150863638934623401342951610891855384631373837149043858823194963942773772579572585255712948420766484630973188783919113666687305951027889256767037672*x^3 + 8485850164269633707590202378641378136837511032218014596735201911194414685635707094347723727895800087292096733956195079010828765375427759307489748403288266709300102337651290830332840954840699425584262128910733508321319312484532948879236924503059168291007018518890329201921430706534756637909185802442161109979222705820648674580348308231372184038765137741673320831918049796135835451560494763964553804685498767932117658303453098292437050524743482656747616858167468012517649468304633506519980638306806909374220322250217452771947904083827200377513671667133562254485852128904352181414407806794013362923673177768050054571393477854903094173212199622364216621627818221624434637055194291062510321093790095865025702038137104930030292165841671222930617562724233490883034107318746624558487967149292314889991280093842841068759545117561943677508809350020391359692512993864795876365233085557931560915801489543177624051111935838651801205777734967036594223923451119291735172033670052199571929678585202237191410458201681983600765322556918363998309407606854452365130716116131716331163119575125029544993027782125647230725459040092463370837744332907018843828008813280113568531910324276059588902897290622865267859862544846860787569380548861976699853867573191808935803185919568176101980229814435511725715486237535418920264932587604809518760420302914368341000169092548491740260607468284728355907416349634671009204703433846362362354804452157624547960607329728278287699400779258566220168553335292607567624433261463666956796210620582293936726998064957175950911074412966*x^2 + 9246055193469528888508361271250966519945332459765722055189463113698681240066601707763567699373114813219021055673136502369091941175175934864553298089105058052784593932396375967231552982060199269454738555457103681957700491390457602548936273031665319875100838479369289636700789746900120461268027958566246619230673015459126696347385531775181645084092310495875822123303547827313124000551974691455431052321982747477733723232212019087652388351180993225938231005765758532329937352110406855995221938653955937405069412039604895159953462689609361861477347896135672860257595165588913434300272812038884292262880444520239124184667209682570205119752792948156264989268678802719474929295501899251744425522960281457307102781539768527110150086636441333396172854456685479296259914763051101326546846863710230871738603079750971852343264646986868132951564073836071435905207986988208914696931219953844818538469179533795821983264019568010204266929582951915569505207290678962710805144149726985779704222721458512868314700839321353384918355304478993268700862966088957187211090418240209176404816629639434361817180802543826891098209901747382514111081339902540513664457725787241431659308297197244579955126113381766223471221718790040752213331232524920315580816682062395138641738827513772563002814550648224679002575375280924195506917766584603753108826719936703650659849231534730154275009704566304548558340575209124200916456649758054657995090531074753732882064674929021523942589166069590891855880577370141927507171211534424121667863104502306615069541076832068802511441402275*x + 498660541395393819938913316974970093099095096361120050496849031841566537239168969780565002229777977470999557538478519554276836851398858584286766950523741725458643121060665990408338835306569477752041283027808216877973418508996136161955481032369047821557364188209190563399419688885737299881567298200335219903544696500928583327347432526276646158636431473627880362164735871308053009549937352718062030659234509963919116106246671713428683950224846508525516946138413298432645463042647246258296229368072859154873464792339510567414225960214627983404679585302317842388049400958696126721315109566755852862827844400507732758982962216896368982654839127602623909296923844661192076247101612639808811584407250395001158377692795838676500303069977811523833664199166752418644265737055283825270344639748280830267315652712115119534096538403204851187016890468743744482911796099002774592303397385154260982429188323168464433280572339148973020143338026833892902438912780897372513850101301179455318272785273406186246420702272194327201178826323105899071157412591961062942554270501029767445642756290901807445053306428651393133090930188518160110668812006907138362064936788769086891061532640904551783257970547287604537829553070699969172093341053495791462370751302329541560808086679760246881362983910504041264876749635269331354458051655284775467789468920601909267541097476062054898811159017512007094343609978920198126874989133040767093730000618695000973142906997491525800452119831304199979211417449594124392879643267486008137366104360268083149033844131761151226701351406
```

2. __用 LLL 搵上面果條 congruence 既 root__

睇左成日 LLL 點玩都係唔明, 請槍借助 https://github.com/mimoo/RSA-and-LLL-attacks。

放返上面果個 N 同埋上面條多項式入去，搵到 `m = 48256277589562736290346738984160936248669152041168006480231762961805279486041361025591223549819869423406508417405`

3. __將個 m 由十進制轉十六進制, 再變返佢做返 d 人睇既野 (flag)__

十進制: `48256277589562736290346738984160936248669152041168006480231762961805279486041361025591223549819869423406508417405`

十六進制: `504354467B4C316E6534725F50346464316E675F77306E745F733476655F5930755F6672306D5F483473376164217D`

旗: `PCTF{L1ne4r_P4dd1ng_w0nt_s4ve_Y0u_fr0m_H4s7ad!}`

輕鬆搞掂, 搞左我成日。
